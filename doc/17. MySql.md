> 《深入浅出 MySQL》

#### 数据类型

#### sql 语句

#### 函数

#### 索引

#### 存储引擎

数据库引擎是数据库底层软件组件，数据库管理系统通过(DBMS)使用数据引擎进行创建、查询、更新和删除数据库操作。不同的存储引擎有不同的存储机制、索引技巧、锁机制等。

mysql 提供了多个存储引擎，有 Innodb、MyISAM、Memory、Merge、Archive、Federated、CSV，BLOCKHOLE 等
可以用`SHOW ENGINES`查看

- INNODB

  Innodb 是 mysql 的默认存储引擎，支持事务、行级锁和外键

  1. 支持事务，提供提交、回滚、崩溃恢复能力的事务安全
  2. innodb 存储引擎完全与 MySQL 服务器整合，Innodb 存储引擎为主内存中缓存数据和索引而维持它自己的缓冲池。innodb 将它的表和索引存在一个逻辑表空间中，表空间可以包含数个文件(或原始磁盘分区).这与 MYISAM 表不同，比如在 myisam 表中每个表被存在分离的文件中。innodb 表可以是任何尺寸，即使在文件尺寸被限制为 2GB 的操作系统
  3. innodb 支持外键完整性约束(FOREIGN KEY)
     存储表中的数据时，每张表的存储都按主键顺序存放，如果没有显示在表定义时指定主键，innodb 会为每一行生成一个 6BROWID，并以此作为主键。

- MYISAM

  MYIASM 是基于 ISAM 存储引擎，并对其扩展。它是在 web、数据仓储和其他应用环境下最常用的存储引擎之一。MYISAM 拥有较高的插入、查询速度，但不支持事务。

  1. 大文件(达 63 位文件长度)在支持大文件的文件系统和操作系统上被支持
  2. 当把删除和更新及插入操作混合使用的时候，动态尺寸的行产生更少碎片。这要通过合并相邻被删除的块，以及若下一个块被删除，就扩展到下一块来自动完成
  3. BLOB 和 TEXT 列可以被索引
  4. 对包含 NULL 值的列可索引
  5. 可以吧数据文件和索引文件放在不同目录
     使用 myisam 引擎创建数据库，将产生 3 个文件。文件的名字以表的名字开始，扩展名指出文件类型：frm 文件存储表定义，数据文件的扩展名为.MYD（MYData），索引文件的扩展名为.MYI（MYIndex）

- MEMORY

  MEMORY 存储引擎将表中数据存储到内存中，为查询和引用其他表数据提供快速访问。

  1. MEMORY 表的每个表可以有多达 32 个索引，每个索引 16 列，以及 500B 的最大键值长度。
  2. MEMORY 存储引擎执行 HASH 和 BTABLE 索引
  3. 可以在 MOMORY 表中有非唯一键
  4. 不支持 BLOB 和 TEXT 列
  5. 对包含 NULL 值的列可索引
  6. MEMORY 表内容存储在内存中，内存是 MEMORY 表和服务器在查询处理的空闲中创建的内部表共享
  7. 当不再需要 MEMORY 表的内容时，要释放被 MEMORY 表使用的内存，应该执行 DELETE FROM 或者 TRUNCATE TABLE 或者删除整个表 DROP TABLE

#### 数据库优化

原则：

1. 减少系统的瓶颈 -- 优化文件系统，提高 IO 读写速度
2. 减少资源的占用 -- 优化操作系统的调度策略，增加负载能力
3. 增加系统的反应速度 -- 优化表结构、索引、查询语句 --> 响应更快

show status 可以查询一些 MySQL 的性能参数
`show status like 'key';`

- key 的取值：
  Connections 连接 MySQL 的次数
  Uptime MySQL 服务器上线时间
  Slow_queries 慢查询的次数
  Com_select 查询操作的次数
  Com_update 更新操作的次数
  Com_delete 删除操作的次数

查询语句优化分析可通过 `Explain` 关键字或 `describe`

**如果查询时没有索引，查询语句将扫描表中的所有记录**

优化索引：

1. 使用 LIKE 关键字的查询语句

在使用 LIKE 关键字进行查询是，如果匹配字符串的第一个字符为"%"，索引不会起作用。只有"%"不再第一个位置，索引才会起作用。

2. 使用多列索引的查询语句

MySQL 可以为多个字段创建索引。一个索引可以包括 16 个字段。对于多列索引，只有查询条件中使用了这些字段中第一个字段时，索引才会被使用。

3. 使用 OR 关键字的查询语句

查询语句的查询条件中只有 OR 关键字，且 OR 前后的两个条件中的列都是索引时，查询中才使用索引。否则，查询将不再使用索引

#### 例题
